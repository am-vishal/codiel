<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
  crossorigin="anonymous"
/>
<link rel="stylesheet" href="/css/main.css" />
<section id="feed-posts">
  <div class="home-heading">
    <h1><%= title %></h1>
  </div>
  <div class="create-post-from">
    <div class="posts-main">
      <div class="posts text-center">
        <form action="/posts/create" id="new-post-form" method="POST">
          <h2 class="post-label" aria-hidden="true">Post</h2>
          <textarea
            name="content"
            rows="3"
            placeholder="Type Here..."
            class="form-control my-3"
            required
          ></textarea>
          <button type="button" class="btn btn-primary btn-sm">Post</button>
        </form>
      </div>
    </div>
  </div>

  <% for( post of posts ) { %>
  <div class="container mt-5 mb-5">
    <div class="row d-flex align-items-center justify-content-center">
      <div class="col-md-4">
        <div class="card">
          <div class="d-flex justify-content-between p-2 px-3">
            <div class="d-flex flex-row align-items-center">
              <img
                src="https://i.imgur.com/UXdKE3o.jpg"
                width="50"
                class="rounded-circle"
              />
              <div class="d-flex flex-column ml-2">
                <span class="font-weight-bold"><%= post.user.name %></span>
                <small class="text-primary">Collegues</small>
              </div>
            </div>
            <div class="d-flex flex-row mt-1 ellipsis">
              <% if (locals.user && locals.user.id==post.user.id){ %>
              <a href="/posts/destroy/<%=post.id%>">Delete</a>
              <% } %>
            </div>
          </div>
          <img
            src="https://i.imgur.com/xhzhaGA.jpg"
            style="object-fit: cover"
            height="250px"
            width="100%"
          />
          <div class="p-2">
            <div class="d-flex justify-content-between align-items-center">
              <div class="d-flex flex-row icons d-flex align-items-center">
                <i class="fa fa-heart"></i> <i class="fa fa-smile-o ml-2"></i>
              </div>
              <div class="d-flex flex-row muted-color">
                <span>2 comments</span>
              </div>
            </div>
            <hr />
            <div class="comments">
              <% for( comment of post.comments ) { %>
              <div class="card m-2 p-1 comment" id="<%= post._id %>">
                <div class="user-banner">
                  <div class="user">
                    <div class="avatar">
                      <img
                        src="https://randomuser.me/api/portraits/men/86.jpg"
                      />
                    </div>
                    <h5><%= comment.user.name %></h5>
                  </div>
                </div>
                <div class="card-text"><%= comment.content %></div>
                <div class="footer">
                  <div class="divider"></div>
                  <span class="is-mute">6 hour</span>
                </div>
              </div>
              <% } %>
              <div class="comment-input card m-1 p-1">
                <% if (locals.user){ %>
                <form action="/comments/create" method="POST">
                  <input
                    type="text"
                    name="content"
                    class="form-control"
                    placeholder="Type Here to add comment..."
                    required
                  />
                  <input type="hidden" name="post" value="<%= post._id %>" />
                  <button type="submit" class="w-50 mt-2 btn btn-primary btn-sm">
                    Add Comment
                  </button>
                </form>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <% } %>
</section>
